{% extends "base.html" %}

{% block title %}CRFMS - Audit Log{% endblock %}

{% block header_title %}üìä Audit Log{% endblock %}

{% block content %}
<div class="content">
    <h2>System Audit Trail</h2>
    <p style="color: #666; margin-bottom: 20px;">Complete history of all system operations</p>
    
    {% if entries %}
    <table>
        <thead>
            <tr>
                <th>Timestamp</th>
                <th>Event Type</th>
                <th>Entity</th>
                <th>Description</th>
                <th>User</th>
            </tr>
        </thead>
        <tbody>
            {% for entry in entries %}
            <tr>
                <td style="font-size: 12px;">{{ entry.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                <td>
                    {% if 'PICKUP' in entry.event_type.name %}
                        <span class="status-badge badge-success">{{ entry.event_type.name }}</span>
                    {% elif 'RETURN' in entry.event_type.name %}
                        <span class="status-badge badge-info">{{ entry.event_type.name }}</span>
                    {% elif 'DAMAGE' in entry.event_type.name or 'OVERRIDE' in entry.event_type.name %}
                        <span class="status-badge badge-warning">{{ entry.event_type.name }}</span>
                    {% elif 'CANCEL' in entry.event_type.name %}
                        <span class="status-badge badge-danger">{{ entry.event_type.name }}</span>
                    {% else %}
                        <span class="status-badge badge-secondary">{{ entry.event_type.name }}</span>
                    {% endif %}
                </td>
                <td>
                    <strong>{{ entry.entity_type }}</strong>
                    {% if entry.entity_id %}#{{ entry.entity_id }}{% endif %}
                </td>
                <td style="max-width: 400px;">{{ entry.description }}</td>
                <td>{{ entry.user or '-' }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <div class="empty-state-icon">üìä</div>
        <h3>No Audit Entries</h3>
        <p>No operations have been logged yet</p>
    </div>
    {% endif %}

    <div style="background: #e7f3ff; border-left: 4px solid #2196F3; padding: 20px; margin-top: 30px; border-radius: 5px;">
        <h4 style="color: #2196F3; margin-bottom: 10px;">‚ÑπÔ∏è About Audit Log</h4>
        <p style="color: #555;">
            The audit log provides a complete, immutable record of all system operations including:
            pickups, returns, extensions, damage charges, manual overrides, and upgrade decisions.
            This ensures full traceability and accountability for compliance purposes.
        </p>
    </div>
</div>
{% endblock %}
